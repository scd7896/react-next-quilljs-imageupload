{"ast":null,"code":"import React, { useState, useEffect, useRef } from 'react';\nimport Link from 'next/link';\nimport axios from 'axios';\n\nconst EditPost = () => {\n  let ReactQuill;\n  let quillRef = useRef();\n  let dropzone = useRef();\n  let DropZone, ImageFile;\n  const [text, setText] = useState('');\n  const [showContent, setShowContent] = useState('');\n\n  if (typeof window !== 'undefined') {\n    ReactQuill = require('react-quill');\n  }\n\n  const quillModules = {\n    toolbar: {\n      container: [['bold', 'italic', 'underline', 'strike'], ['image']],\n      handlers: {\n        image: () => {\n          const input = document.createElement('input');\n          input.setAttribute('type', 'file');\n          input.setAttribute('accept', 'image/*');\n          input.click();\n          input.addEventListener('change', async () => {\n            console.log('이미지 변환됨');\n            const file = input.files[0];\n            const formData = new FormData();\n            formData.append('image', file);\n            const quill = quillRef.current.getEditor();\n            const range = quill.getSelection(true);\n            const res = await axios.post('http://localhost:3060/api/image', formData);\n            quill.setSelection(range.index + 1);\n            quill.deleteText(range.index, 1);\n            quill.insertEmbed(range.index, 'image', `../../uploads/${res.data}`);\n          });\n        }\n      }\n    }\n  };\n\n  const setContent = e => {\n    if (e.match(/^<p><img/g)) {\n      //여기서 변환 코드를 작성하자\n      console.log('파일이 들어온것이여');\n    }\n\n    console.log(e);\n    setText(e);\n  };\n\n  const saveContents = () => {\n    let arr = text.split('<p>');\n    arr = arr.filter(e => e !== '');\n    arr = arr.map(el => '<p>' + el);\n    console.log(arr);\n    axios.post('http://localhost:3060/api/posts', {\n      title: 'test',\n      arr\n    }); // axios.get('http://localhost:3060/api/test')\n    //     .then((res)=> setShowContent(res.data))\n    //     .catch((err)=> console.error(err))\n    // socket.on('connect', ()=>{\n    //     console.log(socket.id)\n    // })\n    // webSocekt.onmessage = (e)=>{\n    //     console.log(e.data)\n    // }\n    // webSocekt.onopen = ()=>{\n    //     console.log(text)\n    //     conn.send(text)\n    // }\n    // webSocekt.onerror = (message)=>{\n    //      console.log(message)\n    // }\n\n    setText('');\n  };\n\n  useEffect(() => {}, []);\n  return typeof window !== \"undefined\" && ReactQuill ? React.createElement(\"div\", null, React.createElement(\"label\", null, React.createElement(ReactQuill, {\n    ref: quillRef,\n    value: text,\n    placeholder: '내용을 입력하시오',\n    modules: quillModules,\n    onChange: setContent\n  })), React.createElement(\"button\", {\n    onClick: saveContents\n  }, \"\\uB0B4\\uC6A9 \\uC800\\uC7A5\\uD574\\uBC84\\uB9AC\\uAE30~\"), React.createElement(Link, {\n    href: {\n      pathname: `/posts`,\n      query: {\n        id: 2\n      }\n    },\n    as: `/posts/2`\n  }, React.createElement(\"a\", null, \"\\uB0B4\\uC6A9 \\uBD88\\uB7EC\\uBC84\\uB9AC\\uAE30\")), React.createElement(\"div\", null, showContent ? showContent : '', React.createElement(\"img\", {\n    src: \"C:\\\\\\\\Users\\\\\\\\scd78\\\\\\\\Desktop\\\\\\\\react-next-quilljs\\\\\\\\uploads\\\\\\\\\\uB514\\uBE44 \\uCD5C\\uC885\\uBCF81565848383953.jpg\"\n  }), \"\\uC544\\uC544\\uC544\\uC544\")) : null;\n};\n\nexport default EditPost;","map":{"version":3,"sources":["C:\\Users\\scd78\\Desktop\\react-next-quilljs\\front\\components\\TestEdit.js"],"names":["React","useState","useEffect","useRef","Link","axios","EditPost","ReactQuill","quillRef","dropzone","DropZone","ImageFile","text","setText","showContent","setShowContent","window","require","quillModules","toolbar","container","handlers","image","input","document","createElement","setAttribute","click","addEventListener","console","log","file","files","formData","FormData","append","quill","current","getEditor","range","getSelection","res","post","setSelection","index","deleteText","insertEmbed","data","setContent","e","match","saveContents","arr","split","filter","map","el","title","pathname","query","id"],"mappings":"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","sourcesContent":["import React,{useState, useEffect, useRef} from 'react'\r\nimport Link from 'next/link'\r\nimport axios from 'axios'\r\n\r\n\r\nconst EditPost = ()=>{\r\n    let ReactQuill\r\n    let quillRef = useRef()\r\n    let dropzone = useRef()\r\n    let DropZone, ImageFile\r\n    const [text, setText] = useState('')\r\n    const [showContent, setShowContent] = useState('')\r\n    if(typeof window !== 'undefined'){\r\n        ReactQuill = require('react-quill')\r\n    }\r\n    \r\n    \r\n    const quillModules = {\r\n        toolbar :{\r\n            container : [['bold', 'italic', 'underline', 'strike'], ['image']],\r\n            handlers :{\r\n                image : ()=>{\r\n                    const input = document.createElement('input')\r\n                    input.setAttribute('type', 'file')\r\n                    input.setAttribute('accept', 'image/*')\r\n                    input.click()\r\n                    input.addEventListener('change',async()=>{\r\n                        console.log('이미지 변환됨')\r\n                        const file = input.files[0]\r\n                        const formData = new FormData()\r\n                        \r\n                        formData.append('image', file)\r\n                        const quill = quillRef.current.getEditor()\r\n                        const range = quill.getSelection(true);    \r\n                        const res = await axios.post('http://localhost:3060/api/image', formData)\r\n                        \r\n                        quill.setSelection(range.index+1)\r\n                        quill.deleteText(range.index, 1)\r\n                        quill.insertEmbed(range.index, 'image',`../../uploads/${res.data}`)\r\n                    })\r\n                    \r\n                    \r\n                    \r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    const setContent = (e)=>{\r\n        if(e.match(/^<p><img/g)){\r\n            //여기서 변환 코드를 작성하자\r\n            console.log('파일이 들어온것이여')\r\n        }\r\n        console.log(e)\r\n        setText(e)\r\n    }\r\n    const saveContents = ()=>{\r\n        let arr = text.split('<p>')\r\n        arr = arr.filter((e)=> e !== '')\r\n        arr =arr.map(el => '<p>' +el)\r\n        console.log(arr)\r\n        \r\n        axios.post('http://localhost:3060/api/posts',{\r\n            title : 'test',\r\n            arr\r\n        })\r\n        // axios.get('http://localhost:3060/api/test')\r\n        //     .then((res)=> setShowContent(res.data))\r\n        //     .catch((err)=> console.error(err))\r\n        // socket.on('connect', ()=>{\r\n        //     console.log(socket.id)\r\n        // })\r\n        // webSocekt.onmessage = (e)=>{\r\n        //     console.log(e.data)\r\n        // }\r\n        // webSocekt.onopen = ()=>{\r\n        //     console.log(text)\r\n        //     conn.send(text)\r\n        // }\r\n        // webSocekt.onerror = (message)=>{\r\n        //      console.log(message)\r\n        // }\r\n        setText('')\r\n    }\r\n    useEffect(()=>{\r\n\r\n    },[])\r\n    return typeof window !== \"undefined\" && ReactQuill ? (\r\n      <div>\r\n          <label>\r\n            <ReactQuill\r\n                ref = {quillRef}\r\n                value = {text}\r\n                placeholder = {'내용을 입력하시오'}\r\n                modules = {quillModules}\r\n                onChange={setContent}\r\n            />\r\n        </label>\r\n        <button onClick ={saveContents}>내용 저장해버리기~</button>\r\n        <Link href = {{pathname : `/posts`, query:{id : 2}}} \r\n            as ={`/posts/2`}><a>내용 불러버리기</a></Link>\r\n        <div>\r\n            {showContent ? showContent: ''}\r\n            <img src = \"C:\\\\Users\\\\scd78\\\\Desktop\\\\react-next-quilljs\\\\uploads\\\\디비 최종본1565848383953.jpg\" />\r\n            아아아아\r\n        </div>\r\n      </div>\r\n      \r\n    ) : null;\r\n  }\r\n\r\nexport default EditPost"]},"metadata":{},"sourceType":"module"}